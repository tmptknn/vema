(function(l){function m(){var k={},h=function(b,a,c){this.f=[b,a,c]};h.prototype.length=function(){return this.calcLength()};h.prototype.lengthSquared=function(){var b=this.f;return b[0]*b[0]+b[1]*b[1]+b[2]*b[2]};h.prototype.calcLength=function(){var b=this.f;return Math.sqrt(b[0]*b[0]+b[1]*b[1]+b[2]*b[2])};h.prototype.normalized=function(){var b=this.length;return 0<b?new h(this.f[0]/b,this.f[1]/b,this.f[2]/b):new h(0,0,0)};h.prototype.addToThis=function(b){this.f[0]+=b.f[0];this.f[1]+=b.f[1];this.f[2]+=
b.f[2]};h.prototype.divide=function(b){return new h(this.f[0]/b,this.f[1]/b,this.f[2]/b)};h.prototype.subtract=function(b){return new h(this.f[0]-b.f[0],this.f[1]-b.f[1],this.f[2]-b.f[2])};h.prototype.add=function(b){return new h(this.f[0]+b.f[0],this.f[1]+b.f[1],this.f[2]+b.f[2])};h.prototype.multiple=function(b){return new h(this.f[0]*b,this.f[1]*b,this.f[2]*b)};h.prototype.negative=function(){return new h(-this.f[0],-this.f[1],-this.f[2])};h.prototype.cross=function(b){var a=this.f;return new h(a[1]*
b.f[2]-a[2]*b.f[1],a[2]*b.f[0]-a[0]*b.f[2],a[0]*b.f[1]-a[1]*b.f[0])};h.prototype.dot=function(b){var a=this.f;return a[0]*b.f[0]+a[1]*b.f[1]+a[2]*b.f[2]};h.prototype.clone=function(){return new h(this.f[0],this.f[1],this.f[2])};h.prototype.setZero=function(){this.f[0]=0;this.f[1]=0;this.f[2]=0;return this};var f=function(){this.m=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};f.prototype.makeFrustum=function(b,a,c,d,g,e){return this.m=[2*g/(a-b),0,0,0,0,2*g/(d-c),0,0,(a+b)/(a-b),(d+c)/(d-c),-(e+g)/(e-g),-1,0,
0,-2*e*g/(e-g),0]};f.prototype.makePerspective=function(b,a,c,d){b=c*Math.tan(b*Math.PI/360);var g=-b;return this.makeFrustum(g*a,b*a,g,b,c,d)};f.prototype.flatten=function(){return this.m};f.prototype.setMatrixData=function(b){16===b.length&&(this.m=[b[0],b[1],b[2],b[3],b[4],b[5],b[6],b[7],b[8],b[9],b[10],b[11],b[12],b[13],b[14],b[15]])};f.prototype.multiple=function(b){var a=new f;b=b.m;var c=this.m;a.setMatrixData([c[0]*b[0]+c[1]*b[4]+c[2]*b[8]+c[3]*b[12],c[0]*b[1]+c[1]*b[5]+c[2]*b[9]+c[3]*b[13],
c[0]*b[2]+c[1]*b[6]+c[2]*b[10]+c[3]*b[14],c[0]*b[3]+c[1]*b[7]+c[2]*b[11]+c[3]*b[15],c[4]*b[0]+c[5]*b[4]+c[6]*b[8]+c[7]*b[12],c[4]*b[1]+c[5]*b[5]+c[6]*b[9]+c[7]*b[13],c[4]*b[2]+c[5]*b[6]+c[6]*b[10]+c[7]*b[14],c[4]*b[3]+c[5]*b[7]+c[6]*b[11]+c[7]*b[15],c[8]*b[0]+c[9]*b[4]+c[10]*b[8]+c[11]*b[12],c[8]*b[1]+c[9]*b[5]+c[10]*b[9]+c[11]*b[13],c[8]*b[2]+c[9]*b[6]+c[10]*b[10]+c[11]*b[14],c[8]*b[3]+c[9]*b[7]+c[10]*b[11]+c[11]*b[15],c[12]*b[0]+c[13]*b[4]+c[14]*b[8]+c[15]*b[12],c[12]*b[1]+c[13]*b[5]+c[14]*b[9]+
c[15]*b[13],c[12]*b[2]+c[13]*b[6]+c[14]*b[10]+c[15]*b[14],c[12]*b[3]+c[13]*b[7]+c[14]*b[11]+c[15]*b[15]]);return a};f.prototype.multipleV=function(b){var a=this.m;return new h(b.f[0]*a[0]+b.f[1]*a[4]+b.f[2]*a[8]+a[12],b.f[0]*a[1]+b.f[1]*a[5]+b.f[2]*a[9]+a[13],b.f[0]*a[2]+b.f[1]*a[6]+b.f[2]*a[10]+a[14])};f.prototype.rotationYMatrix=function(b){var a=Math.cos(b);b=Math.sin(b);return this.m=[a,0,-b,0,0,1,0,0,b,0,a,0,0,0,0,1]};f.prototype.rotationXMatrix=function(b){var a=Math.cos(b);b=Math.sin(b);return this.m=
[1,0,0,0,0,a,-b,0,0,b,a,0,0,0,0,1]};f.prototype.rotationZMatrix=function(b){var a=Math.cos(b);b=Math.sin(b);return this.m=[a,-b,0,0,b,a,0,0,0,0,1,0,0,0,0,1]};f.prototype.rotationQMatrix=function(b){return this.m=[1-2*b[1]*b[1]-2*b[2]*b[2],2*b[0]*b[1]+2*b[2]*b[3],2*b[0]*b[2]-2*b[1]*b[3],0,2*b[0]*b[1]-2*b[2]*b[3],1-2*b[0]*b[0]-2*b[2]*b[2],2*b[1]*b[2]+2*b[0]*b[3],0,2*b[0]*b[2]+2*b[1]*b[3],2*b[1]*b[2]-2*b[0]*b[3],1-2*b[0]*b[0]-2*b[1]*b[1],0,0,0,0,1]};f.prototype.rotateMatrix=function(b,a){var c=Math.cos(b),
d=Math.sin(b),g=1-c,e=a.f;return this.m=[e[0]*e[0]*g+c,e[0]*e[1]*g-e[2]*d,e[0]*e[2]*g+e[1]*d,0,e[1]*e[0]*g+e[2]*d,e[1]*e[1]*g+c,e[1]*e[2]*g-e[0]*d,0,e[2]*e[0]*g-e[1]*d,e[2]*e[1]*g+e[0]*d,e[2]*e[2]*g+c,0,0,0,0,1]};f.prototype.translate=function(b,a,c){return this.m=[1,0,0,0,0,1,0,0,0,0,1,0,b,a,c,1]};f.prototype.scale=function(b,a,c){return this.m=[b,0,0,0,0,a,0,0,0,0,c,0,0,0,0,1]};f.prototype.randomRotationMatrix=function(){var b=Math.random()*Math.PI*2,a=Math.random()*Math.PI*2,c=2*Math.random(),
d=Math.sqrt(c),g=Math.sin(a)*d,a=Math.cos(a)*d,d=Math.sqrt(2-c),e=Math.sin(b),b=Math.cos(b),f=g*b-a*e,h=g*e+a*b;return this.m=[g*f-b,g*h-e,g*d,0,a*f+e,a*h-b,a*d,0,d*f,d*h,1-c,0,0,0,0,1]};f.prototype.makeLookAt=function(b,a,c,d){var g=new f;g.setMatrixData([1,0,0,0,0,1,0,0,0,0,1,0,-d.f[0],-d.f[1],-d.f[2],1]);d=new f;d.setMatrixData([c.f[0],a.f[0],b.f[0],0,c.f[1],a.f[1],b.f[1],0,c.f[2],a.f[2],b.f[2],0,0,0,0,1]);return this.m=g.multiple(d).m};f.prototype.makeLookAt2=function(b,a,c,d){var g=new f;g.setMatrixData([1,
0,0,0,0,1,0,0,0,0,1,0,-d.f[0],-d.f[1],-d.f[2],1]);d=new f;d.setMatrixData([c.f[0],c.f[1],c.f[2],0,a.f[0],a.f[1],a.f[2],0,b.f[0],b.f[1],b.f[2],0,0,0,0,1]);return this.m=g.multiple(d).m};f.prototype.invert=function(){var b=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],a;a=this.m;b[0]=a[5]*a[10]*a[15]-a[5]*a[11]*a[14]-a[9]*a[6]*a[15]+a[9]*a[7]*a[14]+a[13]*a[6]*a[11]-a[13]*a[7]*a[10];b[4]=-a[4]*a[10]*a[15]+a[4]*a[11]*a[14]+a[8]*a[6]*a[15]-a[8]*a[7]*a[14]-a[12]*a[6]*a[11]+a[12]*a[7]*a[10];b[8]=a[4]*a[9]*a[15]-a[4]*
a[11]*a[13]-a[8]*a[5]*a[15]+a[8]*a[7]*a[13]+a[12]*a[5]*a[11]-a[12]*a[7]*a[9];b[12]=-a[4]*a[9]*a[14]+a[4]*a[10]*a[13]+a[8]*a[5]*a[14]-a[8]*a[6]*a[13]-a[12]*a[5]*a[10]+a[12]*a[6]*a[9];b[1]=-a[1]*a[10]*a[15]+a[1]*a[11]*a[14]+a[9]*a[2]*a[15]-a[9]*a[3]*a[14]-a[13]*a[2]*a[11]+a[13]*a[3]*a[10];b[5]=a[0]*a[10]*a[15]-a[0]*a[11]*a[14]-a[8]*a[2]*a[15]+a[8]*a[3]*a[14]+a[12]*a[2]*a[11]-a[12]*a[3]*a[10];b[9]=-a[0]*a[9]*a[15]+a[0]*a[11]*a[13]+a[8]*a[1]*a[15]-a[8]*a[3]*a[13]-a[12]*a[1]*a[11]+a[12]*a[3]*a[9];b[13]=
a[0]*a[9]*a[14]-a[0]*a[10]*a[13]-a[8]*a[1]*a[14]+a[8]*a[2]*a[13]+a[12]*a[1]*a[10]-a[12]*a[2]*a[9];b[2]=a[1]*a[6]*a[15]-a[1]*a[7]*a[14]-a[5]*a[2]*a[15]+a[5]*a[3]*a[14]+a[13]*a[2]*a[7]-a[13]*a[3]*a[6];b[6]=-a[0]*a[6]*a[15]+a[0]*a[7]*a[14]+a[4]*a[2]*a[15]-a[4]*a[3]*a[14]-a[12]*a[2]*a[7]+a[12]*a[3]*a[6];b[10]=a[0]*a[5]*a[15]-a[0]*a[7]*a[13]-a[4]*a[1]*a[15]+a[4]*a[3]*a[13]+a[12]*a[1]*a[7]-a[12]*a[3]*a[5];b[14]=-a[0]*a[5]*a[14]+a[0]*a[6]*a[13]+a[4]*a[1]*a[14]-a[4]*a[2]*a[13]-a[12]*a[1]*a[6]+a[12]*a[2]*
a[5];b[3]=-a[1]*a[6]*a[11]+a[1]*a[7]*a[10]+a[5]*a[2]*a[11]-a[5]*a[3]*a[10]-a[9]*a[2]*a[7]+a[9]*a[3]*a[6];b[7]=a[0]*a[6]*a[11]-a[0]*a[7]*a[10]-a[4]*a[2]*a[11]+a[4]*a[3]*a[10]+a[8]*a[2]*a[7]-a[8]*a[3]*a[6];b[11]=-a[0]*a[5]*a[11]+a[0]*a[7]*a[9]+a[4]*a[1]*a[11]-a[4]*a[3]*a[9]-a[8]*a[1]*a[7]+a[8]*a[3]*a[5];b[15]=a[0]*a[5]*a[10]-a[0]*a[6]*a[9]-a[4]*a[1]*a[10]+a[4]*a[2]*a[9]+a[8]*a[1]*a[6]-a[8]*a[2]*a[5];a=a[0]*b[0]+a[1]*b[4]+a[2]*b[8]+a[3]*b[12];if(0==a)return new f;a=1/a;var c=new f;c.setMatrixData([b[0]*
a,b[1]*a,b[2]*a,b[3]*a,b[4]*a,b[5]*a,b[6]*a,b[7]*a,b[8]*a,b[9]*a,b[10]*a,b[11]*a,b[12]*a,b[13]*a,b[14]*a,b[15]*a]);return c};f.prototype.transpose=function(){var b=this.m,a=new f;a.setMatrixData([b[0],b[4],b[8],b[12],b[1],b[5],b[9],b[13],b[2],b[6],b[10],b[14],b[3],b[7],b[11],b[15]]);return a};k.Vec3=h;k.Matrix4=f;return k}"undefined"===typeof VemaLib?l.VemaLib=m():console.log("Library already defined.")})(window);
